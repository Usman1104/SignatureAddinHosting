function checkSignature(e){var t=Office.context.mailbox.item;t.from.getAsync((function(o){if(o.status===Office.AsyncResultStatus.Failed)return console.log(o.error.message),void e.completed();fetch("https://uaeportal.greensignature.net/Api/ApiSign?sEmail=raju@asnc.ae").then((function(e){if(!e.ok)throw new Error("Network response was not ok");return e.text()})).then((function(o){try{var n=JSON.parse(o);if(console.log(n),n[1]&&""!==n[1]){var s=n[1];t.body.setSignatureAsync(s,{coercionType:Office.CoercionType.Html},(function(o){if(o.status===Office.AsyncResultStatus.Failed)return console.log(o.error.message),void e.completed();var n={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:"Company signature added.",icon:"none",persistent:!1};t.notificationMessages.addAsync("signature_notification",n,(function(t){t.status===Office.AsyncResultStatus.Failed&&console.log(t.error.message),e.completed()}))}))}else console.log("Signature is empty or missing."),e.completed()}catch(t){console.error("Error parsing signature JSON:",t),e.completed()}})).catch((function(t){console.error("Fetch error:",t),e.completed()}))}))}Office.onReady();