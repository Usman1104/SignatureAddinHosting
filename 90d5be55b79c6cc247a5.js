function checkSignature(e){var t=Office.context.mailbox.item;t.from.getAsync((function(n){if(n.status===Office.AsyncResultStatus.Failed)return console.log(n.error.message),void e.completed();var A={asyncContext:n.value.displayName,isInline:!0};t.addFileAttachmentFromBase64Async("iVBORw0KGgoAAAANSUhEUgAAACcAAAAnCAMAAAC7faEHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAzUExURQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKMFRskAAAAQdFJOUwAQIDBAUGBwgI+fr7/P3+8jGoKKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABT0lEQVQ4T7XT2ZalIAwF0DAJhMH+/6+tJOQqot6X6joPiouNBo3w9/Hd6+hrYnUt6vhLcjEAJevVW0zJxABSlcunhERpjY+UKoNN5+ZgDGu2onNz0OngjP2FM1VdyBW1LtvGeYrBLs7U5I1PTXZt+zifcS3Icw2GcS3vxRY3Vn/iqx31hUyTnV515kdTfbaNhZLI30AceqDiIo4tyKEmJpKdP5M4um+nUwfDWxAXdzqMNKQ14jLdL5ntXzxcRF440mhS6yu882Kxa30RZcUIjTCJg7lscsR4VsMjfX9Q0Vuv/Wd3YosD1J4LuSRtaL7bzXGN1wx2cytUdncDuhA3fu6HPTiCvpQUIjZ3sCcHVbvLtbNTHlysx2w9/s27m9gEb+7CTri6hR1wcTf2gVf3wBRe3CMbcHYvTODkXhnD0+178K/pZ9+n/C1ru/2HAPwAo7YM1X4+tLMAAAAASUVORK5CYII=","signatureIcon.png",A,(function(n){if(n.status===Office.AsyncResultStatus.Failed)return console.log(n.error.message),void e.completed();var A="<img src='cid:signatureIcon.png'>"+n.asyncContext;t.body.setSignatureAsync(A,{coercionType:Office.CoercionType.Html},(function(n){if(n.status===Office.AsyncResultStatus.Failed)return console.log(n.error.message),void e.completed();var A={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:"Company signature added.",icon:"none",persistent:!1};t.notificationMessages.addAsync("signature_notification",A,(function(t){if(t.status===Office.AsyncResultStatus.Failed)return console.log(t.error.message),void e.completed();e.completed()}))}))}))}))}function insert_auto_signature(e,t){fetch("https://uaeportal.greensignature.net/Api/ApiSign?sEmail=raju@asnc.ae").then((function(e){return e.ok||console.log("Network response was not ok"),e.text()})).then((function(e){var n=JSON.parse(e);console.log(n),""!==n[1]&&addTemplateSignature(n[1],t)})).catch((function(e){console.error("Fetch error:",e)}))}function addTemplateSignature(e,t){Office.context.mailbox.item.body.setSignatureAsync(e,{coercionType:"html",asyncContext:t},(function(e){e.asyncContext.completed()}))}function display_insight_infobar(){Office.context.mailbox.item.notificationMessages.addAsync("fd90eb33431b46f58a68720c36154b4a",{type:"insightMessage",message:"Please set your signature with the Office Add-ins sample.",icon:"Icon.16x16",actions:[{actionType:"showTaskPane",actionText:"Set signatures",commandId:get_command_id(),contextData:"{''}"}]})}function get_command_id(){return"appointment"==Office.context.mailbox.item.itemType?"MRCS_TpBtn1":"MRCS_TpBtn0"}function is_valid_data(e){return null!=e&&""!==e}Office.onReady(),Office.actions.associate("checkSignature",checkSignature);